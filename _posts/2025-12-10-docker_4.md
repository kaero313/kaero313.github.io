---
title: "[ë„ì»¤-4] CI/CD ìë™í™”: GitHub Actionsë¥¼ í†µí•œ ë„ì»¤ ì´ë¯¸ì§€ ë¹Œë“œì™€ ìë™ ë°°í¬"
date: 2025-12-10 13:49:31 +0900
categories: [Infra, Docker]
tags: [ë„ì»¤, ì¸í”„ë¼, ì„œë²„]
---

<div align="center">
  <img src="assets/img/docker/github_actions.png" alt="ê¹ƒí—ˆë¸Œ ì•¡ì…˜ ì•„ì´ì½˜" width="500">
</div>

> ì•„ë‹ˆ ë„ì»¤ ì–˜ê¸°ì¤‘ì¸ë° ê°‘ìê¸° ê¹ƒí—ˆë¸Œ ê´€ë ¨í•œê²Œ ì™œ ë‚˜ì˜´ ?

ë„ì»¤ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê¹”ë”í•˜ê²Œ ì»¨í…Œì´ë„ˆí™”í•˜ëŠ” ê²ƒê¹Œì§„ ì„±ê³µí–ˆë‹¤. ê·¸ëŸ°ë° ë¬¸ë“ ê¶ê¸ˆì¦ì´ ìƒê²¼ë‹¤.<br/>
"ë‚´ê°€ ë§Œë“  ì´ ì´ë¯¸ì§€ë¥¼ ì½”ë“œê°€ ë°”ë€” ë•Œë§ˆë‹¤ ìë™ìœ¼ë¡œ ë¹Œë“œí•˜ê³ , ì„œë²„ì— ì˜¬ë¦¬ëŠ” ê³¼ì •ì€ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œ?"<br/>
ê²°êµ­ ë„ì»¤ì˜ ê¶ê·¹ì ì¸ ëª©ì , ì¦‰ 'ì–´ë””ì„œë“  ì‰½ê²Œ ì‹¤í–‰ë˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜'ì„ ì™„ì„±í•˜ë ¤ë©´ ìë™í™” íŒŒì´í”„ë¼ì¸ êµ¬ì¶•ì´ í•„ìˆ˜ì ì´ì—ˆë‹¤.<br/>
Jenkins, GitLab CI/CD, CircleCI, GitHub Actionsë“± ìˆ˜ ë§ì€ CI/CD ë„êµ¬ê°€ ìˆì—ˆëŠ”ë°,<br/>
ì—¬ê¸°ì„œëŠ” GitHub Actionsë¥¼ ì‚¬ìš©í•˜ì—¬ ìë™í™” íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•´ë³´ë„ë¡ í•˜ê² ë‹¤.<br/>
<br/>
ë„ì»¤ê°€ ê²°ê³¼ë¬¼(ì´ë¯¸ì§€)ì„ ë‹´ë‹¹í•œë‹¤ë©´, ì•¡ì…˜ì€ ê³¼ì •(ë¹Œë“œ, í…ŒìŠ¤íŠ¸, ë°°í¬)ì„ ì±…ì„ì§€ëŠ” ì…ˆì´ë‹¤.<br/>
ìµœì¢…ì ì¸ ì›Œí¬ í”Œë¡œìš°ëŠ” ì•„ë˜ì™€ ê°™ì´ ë  ê²ƒì´ë‹¤.

```tree
1. ê°œë°œìê°€ ë¡œì»¬ì—ì„œ ì½”ë“œ ìˆ˜ì •
   â†“
2. ìˆ˜ì • ë‚´ì—­ Git Push
   â†“
3. ìë™ìœ¼ë¡œ ë„ì»¤ ì´ë¯¸ì§€ ë¹Œë“œ
   â†“
4. ë„ì»¤ í—ˆë¸Œ ì—…ë¡œë“œ
```

# ê¹ƒí—ˆë¸Œ
---

## ë ˆí¬ì§€í† ë¦¬ ìƒì„±

ìš°ì„  ì½”ë“œë¥¼ ì˜¬ë¦´ ìˆ˜ ìˆëŠ” ë ˆí¬ì§€í† ë¦¬ê°€ í•„ìš”í•˜ë‹¤.<br/>
docker_github-actions ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ìƒì„±ì„ í•˜ê³ , ë„ì»¤ì™€ ì—°ë™í•˜ê¸° ìœ„í•´<br/>
ë„ì»¤ í—ˆë¸Œ ì—‘ì„¸ìŠ¤ í† í°ì„ ë°œê¸‰ë°›ì•„ ìœ ì € ì´ë¦„ê³¼ í•¨ê»˜ í•´ë‹¹ ë ˆí¬ì§€í† ë¦¬ secretsì— ë“±ë¡ì„ í–ˆë‹¤.<br/>

<div align="left" style="display:flex;">
  <img src="assets/img/docker/dockerhub_token.png" alt="ë„ì»¤ í—ˆë¸Œ í† í°" width="500">
  <img src="assets/img/docker/repo_secrets.png" alt="ë ˆí¬ ì‹œí¬ë¦¿" width="500">
</div>

## ê¹ƒí—ˆë¸Œ ì•¡ì…˜

ê¹ƒí—ˆë¸Œ ì•¡ì…˜ì˜ ì›Œí¬í”Œë¡œìš°ë¥¼ ì •ì˜í•˜ê³ , ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ ë°˜ë“œì‹œ ì§€ì¼œì•¼ í•˜ëŠ” ê·œì¹™ì€ ë‘ ê°€ì§€ì´ë‹¤.
- ë ˆí¬ì§€í† ë¦¬ ìµœìƒë‹¨ì— í•„ìˆ˜ ë””ë ‰í† ë¦¬ëª… ì§€ì •í•˜ì—¬ ìƒì„±: .github/workflows
- í•´ë‹¹ ë””ë ‰í† ë¦¬ ì•ˆì˜ íŒŒì¼ì€ yaml, yml í¬ë§·ìœ¼ë¡œ ì‘ì„±

ë‹¤ìŒì€ .github/workflows/docker-build.ymlì˜ ë‚´ìš©ì´ë‹¤.
```yml
# ============================================
# Workflow ì´ë¦„ (GitHub Actions íƒ­ì— í‘œì‹œë¨)
# ============================================
name: Docker Build and Push

# ============================================
# íŠ¸ë¦¬ê±°: ì–¸ì œ ì´ workflowë¥¼ ì‹¤í–‰í• ì§€ ì •ì˜
# ============================================
on:
  push:
    branches: [ main ]  # main ë¸Œëœì¹˜ì— push ì‹œ ì‹¤í–‰
    tags:
      - 'v*'           # vë¡œ ì‹œì‘í•˜ëŠ” íƒœê·¸ push ì‹œ ì‹¤í–‰ (ì˜ˆ: v1.0, v2.1)

# ============================================
# Jobs: ì‹¤í–‰í•  ì‘ì—…ë“¤
# ============================================
jobs:
  build:
    # Ubuntu ìµœì‹  ë²„ì „ ê°€ìƒ ë¨¸ì‹ ì—ì„œ ì‹¤í–‰
    runs-on: ubuntu-latest
    
    # ============================================
    # Steps: ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰í•  ë‹¨ê³„ë“¤
    # ============================================
    steps:
      # ----------------------------------------
      # Step 1: GitHub ì €ì¥ì†Œì—ì„œ ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
      # ----------------------------------------
      - name: Checkout code
        uses: actions/checkout@v3  # GitHub ê³µì‹ ì•¡ì…˜ ì‚¬ìš©
      
      # ----------------------------------------
      # Step 2: ë²„ì „ ì •ë³´ ì¶”ì¶œ
      # íƒœê·¸ pushë©´ íƒœê·¸ ì´ë¦„(v2.1), ì•„ë‹ˆë©´ 'latest'
      # ----------------------------------------
      - name: Get version
        id: version  # ë‹¤ë¥¸ stepì—ì„œ ì°¸ì¡°í•  ID
        run: |
          # GITHUB_REFê°€ refs/tags/ë¡œ ì‹œì‘í•˜ëŠ”ì§€ í™•ì¸
          if [[ $GITHUB_REF == refs/tags/* ]]; then
            # refs/tags/v2.1 â†’ v2.1 ì¶”ì¶œ
            VERSION=${GITHUB_REF#refs/tags/}
            # ì¶œë ¥ ë³€ìˆ˜ ì„¤ì • (ë‹¤ë¥¸ stepì—ì„œ ì‚¬ìš©)
            echo "version=$VERSION" >> $GITHUB_OUTPUT
            echo "is_release=true" >> $GITHUB_OUTPUT
          else
            # íƒœê·¸ê°€ ì•„ë‹ˆë©´ latest
            echo "version=latest" >> $GITHUB_OUTPUT
            echo "is_release=false" >> $GITHUB_OUTPUT
          fi
      
      # ----------------------------------------
      # Step 3: Docker Hub ë¡œê·¸ì¸
      # GitHub Secretsì— ì €ì¥ëœ ì¸ì¦ ì •ë³´ ì‚¬ìš©
      # ----------------------------------------
      - name: Login to Docker Hub
        uses: docker/login-action@v2  # Docker ê³µì‹ ë¡œê·¸ì¸ ì•¡ì…˜
        with:
          # Settings â†’ Secretsì— ì €ì¥ëœ ê°’ ì‚¬ìš©
          username: ${{ secrets.DOCKER_USERNAME }}
          password: ${{ secrets.DOCKER_TOKEN }}
      
      # ----------------------------------------
      # Step 4: Docker ì´ë¯¸ì§€ ë¹Œë“œ
      # í•­ìƒ latest ë¹Œë“œ, ë¦´ë¦¬ìŠ¤ë©´ ë²„ì „ íƒœê·¸ë„ ë¹Œë“œ
      # ----------------------------------------
      - name: Build Docker image
        run: |
          # latest íƒœê·¸ëŠ” í•­ìƒ ë¹Œë“œ
          docker build -t nayatrei3/nayatrei-app:latest ./app
          
          # ë¦´ë¦¬ìŠ¤(íƒœê·¸ push)ì¸ ê²½ìš°ì—ë§Œ ë²„ì „ íƒœê·¸ ì¶”ê°€ ë¹Œë“œ
          if [[ "${{ steps.version.outputs.is_release }}" == "true" ]]; then
            # ì˜ˆ: nayatrei3/nayatrei-app:v2.1
            docker build -t nayatrei3/nayatrei-app:${{ steps.version.outputs.version }} ./app
          fi
      
      # ----------------------------------------
      # Step 5: Docker Hubì— ì´ë¯¸ì§€ ì—…ë¡œë“œ
      # ë¹Œë“œí•œ ì´ë¯¸ì§€ë“¤ì„ Docker Hubì— push
      # ----------------------------------------
      - name: Push to Docker Hub
        run: |
          # latest íƒœê·¸ëŠ” í•­ìƒ push
          docker push nayatrei3/nayatrei-app:latest
          
          # ë¦´ë¦¬ìŠ¤ì¸ ê²½ìš°ì—ë§Œ ë²„ì „ íƒœê·¸ë„ push
          if [[ "${{ steps.version.outputs.is_release }}" == "true" ]]; then
            # ì˜ˆ: nayatrei3/nayatrei-app:v2.1
            docker push nayatrei3/nayatrei-app:${{ steps.version.outputs.version }}
          fi
      
      # ----------------------------------------
      # Step 6: ê²°ê³¼ ì¶œë ¥ (ë¡œê·¸ì— í‘œì‹œ)
      # ì–´ë–¤ ì´ë¯¸ì§€ê°€ ì—…ë¡œë“œë˜ì—ˆëŠ”ì§€ í™•ì¸ìš©
      # ----------------------------------------
      - name: Image info
        run: |
          # latestëŠ” í•­ìƒ ì¶œë ¥
          echo "âœ… Pushed: nayatrei3/nayatrei-app:latest"
          
          # ë¦´ë¦¬ìŠ¤ì¸ ê²½ìš° ë²„ì „ íƒœê·¸ë„ ì¶œë ¥
          if [[ "${{ steps.version.outputs.is_release }}" == "true" ]]; then
            echo "âœ… Pushed: nayatrei3/nayatrei-app:${{ steps.version.outputs.version }}"
          fi

# ============================================
# ì „ì²´ íë¦„ ìš”ì•½:
# 1. main push â†’ latestë§Œ ë¹Œë“œ/ì—…ë¡œë“œ
# 2. v2.1 tag push â†’ latest + v2.1 ë¹Œë“œ/ì—…ë¡œë“œ
# ============================================
```

- [ê¹ƒí—ˆë¸Œ ì•¡ì…˜ ë¬¸ì„œ](https://docs.github.com/en/actions/reference/workflows-and-actions/workflow-syntax)

íŒŒì¼ì€ ê¸°ë³¸ì ìœ¼ë¡œ yamlí˜•ì‹ìœ¼ë¡œ ì‘ì„±í•˜ë©°, ë‚´ìš©ì€ ê¹ƒí—ˆë¸Œ ì•¡ì…˜ì—ì„œ ì •ì˜í•œ ê³ ìœ ì˜ ë¬¸ë²•ì„ ë”°ë¥¸ë‹¤.<br/>
ì •í™•íˆ ë¬´ìŠ¨ ê¸°ëŠ¥ì¸ì§€ëŠ” ëª¨ë¥´ì§€ë§Œ í‚¤ì›Œë“œë¥¼ ë³´ê³  ìœ ì¶”í•˜ê¸°ì—ëŠ” ì¶©ë¶„í•˜ë‹¤.
> ëª¨ë¥´ë©´ ê·¸ëƒ¥ ëŠê»´

<br/>

# ìë™í™” í…ŒìŠ¤íŠ¸
---

ê°œë°œìê°€ ê°œë°œì„ í•˜ê²Œ ë˜ë©´ í•˜ë£¨ì—ë„ ëª‡ ë²ˆì”© ê¹ƒ ì €ì¥ì†Œì— ì˜¬ë¦´ ì¼ì´ ìƒê¸°ëŠ”ë°,<br/>
ê·¸ì— ë”°ë¼ ìƒê¸°ëŠ” ëª¨ë“  ì´ë¯¸ì§€ë¥¼ ë„ì»¤ í—ˆë¸Œì— íƒœê·¸ë¥¼ ì§€ì •í•˜ì—¬ ì˜¬ë¦´ í•„ìš”ëŠ” ì—†ì„ ê²ƒì´ë‹¤.<br/>
íŠ¹ì • ì‹œì ì˜ ë²„ì „ë§Œ íƒœê·¸ë¥¼ ë”°ì„œ ì˜¬ë¦¬ë©´ ì¶©ë¶„í•˜ê¸°ì— ë§¤ë²ˆ ë®ì–´ì”Œì›Œì§€ëŠ” ë§ˆì§€ë§‰ ì´ë¯¸ì§€ë¥¼ ì•Œë¦¬ëŠ” latest íƒœê·¸ì™€,<br/>
v2.1ì²˜ëŸ¼ ë”°ë¡œ ë„˜ë²„ë§í•´ì„œ ì˜¬ë¦¬ê³  ê´€ë¦¬í•˜ëŠ” íƒœê·¸ ë‘ ê°€ì§€ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ì›Œí¬ í”Œë¡œìš° íŒŒì¼ì„ ì‘ì„±í–ˆì—ˆë‹¤.<br/> 
ì¤€ë¹„ëŠ” ë˜ì—ˆìœ¼ë‹ˆ ì´ì œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ ë³´ê² ë‹¤.

<div align="left" style="display:flex;">
  <img src="assets/img/docker/github-actions_push.png" alt="ê¹ƒ ì €ì¥ì†Œ í‘¸ì‰¬" width="500">
  <img src="assets/img/docker/dockerhub_tag.png" alt="ë„ì»¤ ì €ì¥ì†Œ í‘¸ì‰¬" width="500">
</div>
> daily updateì— ë¹„í•´, weekly updateëŠ” íƒœê·¸ë¥¼ ìƒì„±í•˜ëŠ” ì ˆì°¨ê°€ ë” ì¡´ì¬í•œë‹¤.

ë§¤ì¼ í•˜ëŠ” ì—…ë°ì´íŠ¸ëŠ” ë”°ë¡œ ë²„ì „ ê´€ë¦¬ ì—†ì´ ë§ˆì§€ë§‰ ì´ë¯¸ì§€ë§Œ ì €ì¥í•˜ê³ ,<br/>
ì£¼ì— 1ë²ˆ í•˜ëŠ” ì—…ë°ì´íŠ¸ëŠ” ë²„ì „ ëª…ì„ ì§€ì •í•´ì„œ ë”°ë¡œ ì´ë¯¸ì§€ë¥¼ ì €ì¥í•˜ëŠ” ë°©ì‹ì´ë‹¤.<br/>

## ê° êµ¬ë¬¸ë³„ í•´ì„

- `git push origin main`
  - main ë¸Œëœì¹˜ì˜ ìµœì‹  ìƒíƒœë¥¼ GitHubì— ì—…ë¡œë“œí•œë‹¤.
- `git tag v2.1`
  - í˜„ì¬ ì»¤ë°‹ì— v2.1ì´ë¼ëŠ” íƒœê·¸ë¥¼ ë¶™ì¸ë‹¤.
- `git push origin v2.1`
  - v2.1 íƒœê·¸ë¥¼ GitHubì— ì—…ë¡œë“œí•œë‹¤.


====TODO====

1. í…ŒìŠ¤íŠ¸ ìë™í™” ğŸ§ª
í˜„ì¬ ìƒí™©
ì½”ë“œ ìˆ˜ì • â†’ Push â†’ ë¹Œë“œ â†’ Docker Hub ì—…ë¡œë“œ
í…ŒìŠ¤íŠ¸ ìë™í™” ì¶”ê°€ í›„
ì½”ë“œ ìˆ˜ì • â†’ Push â†’ ìë™ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
                      â†“ (ì„±ê³µ)
                    ë¹Œë“œ â†’ Docker Hub
                      â†“ (ì‹¤íŒ¨)
                    ë¹Œë“œ ì¤‘ë‹¨ âŒ
í•µì‹¬: ë²„ê·¸ ìˆëŠ” ì½”ë“œëŠ” ë°°í¬ ì•ˆ ë¨!

ì˜ˆì‹œ
python# tests/test_app.py
def test_home():
    response = client.get('/')
    assert response.status_code == 200
    assert 'Hello' in response.json()['message']
yaml# GitHub Actions
- name: Run tests
  run: pytest tests/
# í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨í•˜ë©´ ì—¬ê¸°ì„œ ë©ˆì¶¤!
```

**íš¨ê³¼:** ì˜ëª»ëœ ì½”ë“œê°€ Docker Hubì— ì•ˆ ì˜¬ë¼ê°

---

## 2. ì„œë²„ ìë™ ë°°í¬ ğŸš€

### í˜„ì¬ ìƒí™©
```
ì½”ë“œ ìˆ˜ì • â†’ Push â†’ Docker Hub ì—…ë¡œë“œ
                      â†“
                [ìˆ˜ë™ìœ¼ë¡œ ì„œë²„ì—ì„œ]
                ssh server
                docker pull
                docker-compose up -d
```

### ì„œë²„ ìë™ ë°°í¬ ì¶”ê°€ í›„
```
ì½”ë“œ ìˆ˜ì • â†’ Push â†’ Docker Hub ì—…ë¡œë“œ
                      â†“
                GitHub Actionsê°€ ìë™ìœ¼ë¡œ:
                  - ì„œë²„ SSH ì ‘ì†
                  - docker pull
                  - docker-compose restart
                      â†“
                ì„œë²„ ì—…ë°ì´íŠ¸ ì™„ë£Œ! âœ…
í•µì‹¬: Pushë§Œ í•˜ë©´ ì„œë²„ê¹Œì§€ ìë™ ë°°í¬!


